FAIL test/integration/sessions.spec.ts (6.738 s)
  Sessions Integration Tests
    POST /contents/:id/sessions - Create Session
      × should create a new reading session (1 ms)
    Session Phase Transitions
      × should advance from PRE to DURING
      × should reject FINISHED without DoD requirements
      × should allow FINISHED when all DoD met
    Session Events
      × should record quiz response event
      × should record production submit event

  ● Sessions Integration Tests › POST /contents/:id/sessions - Create Session › should create a new reading session

    secretOrPrivateKey must have a value

      91 |     const { JwtService } = await import('@nestjs/jwt');
      92 |     const jwtService = app.get(JwtService);
    > 93 |     const token = jwtService.sign({ sub: testUserId, email: user.email, role: user.role });
         |                              ^
      94 |     authToken = `Bearer ${token}`;
      95 |   });
      96 |   

      at Object.<anonymous>.module.exports [as sign] (../node_modules/jsonwebtoken/sign.js:111:20)
      at JwtService.sign (../node_modules/@nestjs/jwt/dist/jwt.service.js:41:20)
      at Object.<anonymous> (integration/sessions.spec.ts:93:30)

  ● Sessions Integration Tests › Session Phase Transitions › should advance from PRE to DURING

    secretOrPrivateKey must have a value

      91 |     const { JwtService } = await import('@nestjs/jwt');
      92 |     const jwtService = app.get(JwtService);
    > 93 |     const token = jwtService.sign({ sub: testUserId, email: user.email, role: user.role });
         |                              ^
      94 |     authToken = `Bearer ${token}`;
      95 |   });
      96 |   

      at Object.<anonymous>.module.exports [as sign] (../node_modules/jsonwebtoken/sign.js:111:20)
      at JwtService.sign (../node_modules/@nestjs/jwt/dist/jwt.service.js:41:20)
      at Object.<anonymous> (integration/sessions.spec.ts:93:30)

  ● Sessions Integration Tests › Session Phase Transitions › should reject FINISHED without DoD requirements

    secretOrPrivateKey must have a value

      91 |     const { JwtService } = await import('@nestjs/jwt');
      92 |     const jwtService = app.get(JwtService);
    > 93 |     const token = jwtService.sign({ sub: testUserId, email: user.email, role: user.role });
         |                              ^
      94 |     authToken = `Bearer ${token}`;
      95 |   });
      96 |   

      at Object.<anonymous>.module.exports [as sign] (../node_modules/jsonwebtoken/sign.js:111:20)
      at JwtService.sign (../node_modules/@nestjs/jwt/dist/jwt.service.js:41:20)
      at Object.<anonymous> (integration/sessions.spec.ts:93:30)

  ● Sessions Integration Tests › Session Phase Transitions › should allow FINISHED when all DoD met

    secretOrPrivateKey must have a value

      91 |     const { JwtService } = await import('@nestjs/jwt');
      92 |     const jwtService = app.get(JwtService);
    > 93 |     const token = jwtService.sign({ sub: testUserId, email: user.email, role: user.role });
         |                              ^
      94 |     authToken = `Bearer ${token}`;
      95 |   });
      96 |   

      at Object.<anonymous>.module.exports [as sign] (../node_modules/jsonwebtoken/sign.js:111:20)
      at JwtService.sign (../node_modules/@nestjs/jwt/dist/jwt.service.js:41:20)
      at Object.<anonymous> (integration/sessions.spec.ts:93:30)

  ● Sessions Integration Tests › Session Events › should record quiz response event

    secretOrPrivateKey must have a value

      91 |     const { JwtService } = await import('@nestjs/jwt');
      92 |     const jwtService = app.get(JwtService);
    > 93 |     const token = jwtService.sign({ sub: testUserId, email: user.email, role: user.role });
         |                              ^
      94 |     authToken = `Bearer ${token}`;
      95 |   });
      96 |   

      at Object.<anonymous>.module.exports [as sign] (../node_modules/jsonwebtoken/sign.js:111:20)
      at JwtService.sign (../node_modules/@nestjs/jwt/dist/jwt.service.js:41:20)
      at Object.<anonymous> (integration/sessions.spec.ts:93:30)

  ● Sessions Integration Tests › Session Events › should record production submit event

    secretOrPrivateKey must have a value

      91 |     const { JwtService } = await import('@nestjs/jwt');
      92 |     const jwtService = app.get(JwtService);
    > 93 |     const token = jwtService.sign({ sub: testUserId, email: user.email, role: user.role });
         |                              ^
      94 |     authToken = `Bearer ${token}`;
      95 |   });
      96 |   

      at Object.<anonymous>.module.exports [as sign] (../node_modules/jsonwebtoken/sign.js:111:20)
      at JwtService.sign (../node_modules/@nestjs/jwt/dist/jwt.service.js:41:20)
      at Object.<anonymous> (integration/sessions.spec.ts:93:30)

Test Suites: 1 failed, 1 total
Tests:       6 failed, 6 total
Snapshots:   0 total
Time:        6.979 s, estimated 10 s
Ran all test suites matching /test\\integration\\sessions.spec.ts/i.
