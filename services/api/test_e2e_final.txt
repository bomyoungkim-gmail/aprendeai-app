FAIL test/e2e/extension-webclip.e2e-spec.ts (5.574 s)
  ● Extension E2E Journey › Example Journey: Connect -> Capture -> Session

    expected 200 "OK", got 404 "Not Found"

      145 |       .get('/api/v1/sessions')
      146 |       .set('Authorization', `Bearer ${userToken}`)
    > 147 |       .expect(200);
          |        ^
      148 |
      149 |     const session = mySessionsRes.body.find((s: any) => s.id === sessionId);
      150 |     expect(session).toBeDefined();

      at Object.<anonymous> (test/e2e/extension-webclip.e2e-spec.ts:147:8)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)


  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.content.deleteMany()` invocation in
    C:\projects\aprendeai-app\services\api\test\e2e\extension-webclip.e2e-spec.ts:63:28

      60 await prisma.extensionDeviceAuth.deleteMany({ where: { userId } });
      61 await prisma.extensionGrant.deleteMany({ where: { userId } });
      62 await prisma.readingSession.deleteMany({ where: { userId } });
    → 63 await prisma.content.deleteMany(
    Foreign key constraint violated: `content_versions_content_id_fkey (index)`

      61 |       await prisma.extensionGrant.deleteMany({ where: { userId } });
      62 |       await prisma.readingSession.deleteMany({ where: { userId } });
    > 63 |       await prisma.content.deleteMany({ where: { createdBy: userId } });
         |       ^
      64 |       await prisma.user.delete({ where: { id: userId } });
      65 |     }
      66 |     await prisma.$disconnect();

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (test/e2e/extension-webclip.e2e-spec.ts:63:7)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        5.765 s, estimated 8 s
Ran all test suites matching /test\\e2e\\extension-webclip.e2e-spec.ts/i.
Jest did not exit one second after the test run has completed.

'This usually means that there are asynchronous operations that weren't stopped in your tests. Consider running Jest with `--detectOpenHandles` to troubleshoot this issue.
