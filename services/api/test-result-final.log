
> api@0.0.1 test:e2e
> jest --config ./test/jest-e2e.json session-history.e2e-spec.ts --runInBand --no-coverage

FAIL test/e2e/session-history.e2e-spec.ts (5.803 s)
  Session History API (E2E)
    GET /api/v1/sessions
      √ should return paginated sessions with default params (36 ms)
      × should respect page and limit parameters (21 ms)
      √ should filter by phase (30 ms)
      √ should filter by date range (15 ms)
      √ should search by content title (16 ms)
      √ should enforce max limit of 100 (12 ms)
      √ should return 401 without auth token (4 ms)
    GET /api/v1/sessions/export
      √ should export as JSON by default (12 ms)
      √ should export as CSV when format=csv (12 ms)
      √ should return 401 without auth token (7 ms)
    GET /api/v1/sessions/analytics
      √ should return analytics with default 30 days (10 ms)
      √ should respect custom days parameter (10 ms)
      √ should return activity grouped by date (9 ms)
      √ should return 401 without auth token (3 ms)

  ● Session History API (E2E) › GET /api/v1/sessions › should respect page and limit parameters

    expect(received).toMatchObject(expected)

    - Expected  - 1
    + Received  + 1

      Object {
        "limit": 10,
    -   "page": 2,
    +   "page": "2",
      }

      115 |         .set('Authorization', authToken)
      116 |         .expect(200)
    > 117 |         .expect((res) => {
          |          ^
      118 |           expect(res.body.sessions.length).toBeLessThanOrEqual(10);
      119 |           expect(res.body.pagination).toMatchObject({
      120 |             page: 2,

      at Object.<anonymous> (test/e2e/session-history.e2e-spec.ts:117:10)
      ----
      at test/e2e/session-history.e2e-spec.ts:119:39
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 13 passed, 14 total
Snapshots:   0 total
Time:        6.001 s, estimated 8 s
Ran all test suites matching /session-history.e2e-spec.ts/i.
